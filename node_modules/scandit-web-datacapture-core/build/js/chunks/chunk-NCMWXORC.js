import { a as a$1 } from './chunk-P2Q6B4XC.js';
import { d } from './chunk-4HOEKH6K.js';
import { a } from './chunk-SP3HSP4K.js';
import { a as a$2 } from './chunk-CLY2FGU2.js';
import { f as f$1, g } from './chunk-36CGJKPG.js';

var b=(e=>(e.Idle="idle",e.Pressed="pressed",e))(b||{}),l=class{constructor(t,e){this.state="idle";this.isHover=!1;this.control=t,this.domHost=e,this.onTouchStartListener=this.onTouchStart.bind(this),this.onMouseEnterListener=this.onMouseEnter.bind(this),this.onMouseLeaveListener=this.onMouseLeave.bind(this),this.onClickListener=this.onClick.bind(this),this.setup();}get frameSource(){var t,e;return (e=(t=this.control.view)==null?void 0:t.getContext())==null?void 0:e.frameSource}get context(){var t;return (t=this.control.view)==null?void 0:t.getContext()}async install(){this.button||this.setup();let t=await this.canShow();return t?(this.updateButtonBackground(this.button,this.getImageFromState()),this.show()):this.hide(),t}remove(t=!1){t&&this.button?(this.button.removeEventListener("mouseenter",this.onMouseEnterListener),this.button.removeEventListener("mouseleave",this.onMouseLeaveListener),this.button.removeEventListener("touchstart",this.onTouchStartListener),this.button.removeEventListener("click",this.onClickListener),this.button.remove(),this.isHover=!1,this.button=void 0):this.hide();}hide(){this.button&&(this.button.style.display="none");}show(){this.button&&(this.button.style.display="block");}setupButton(){let t=document.createElement("button");return t.type="button",t.style.display="none",t.className=`scandit-control-widget scandit-control-widget-${this.control.type}`,this.updateButtonBackground(t,this.getImageFromState()),this.domHost.append(t),t.addEventListener("mouseenter",this.onMouseEnterListener),t.addEventListener("mouseleave",this.onMouseLeaveListener),a$2.isDesktopDevice()||t.addEventListener("touchstart",this.onTouchStartListener),t.addEventListener("click",this.onClickListener),t.setAttribute("aria-pressed",String(this.state==="pressed")),this.button=t,this.button}setup(){this.setupButton();}onTouchStart(){var t,e;(t=this.button)==null||t.removeEventListener("mouseenter",this.onMouseEnterListener),(e=this.button)==null||e.removeEventListener("mouseleave",this.onMouseLeaveListener);}onMouseEnter(){this.isHover=!0,this.updateButtonBackground(this.button,this.getImageFromState());}onMouseLeave(){this.isHover=!1,this.updateButtonBackground(this.button,this.getImageFromState());}onClick(){var t;this.state=this.state==="pressed"?"idle":"pressed",this.buttonClicked(),this.updateButtonBackground(this.button,this.getImageFromState()),(t=this.button)==null||t.setAttribute("aria-pressed",String(this.state==="pressed"));}updateButtonBackground(t,e){e!=null&&t!=null&&(t.style.backgroundImage=`url(${JSON.stringify(e)})`);}},v=class extends l{constructor(t,e){super(t,e);}async buttonClicked(){await this.frameSource.setDesiredTorchState(this.retrieveTorchState()==="on"?"off":"on");}async canShow(){return this.isTorchAvailable()}getImageFromState(){return this.retrieveTorchState()==="on"?this.isHover?this.control.torchOnPressedImage:this.control.torchOnImage:this.isHover?this.control.torchOffPressedImage:this.control.torchOffImage}setup(){if(this.control.torchOffImage==null||this.control.torchOnImage==null){a.log(a.Level.Warn,"TorchSwitchControl icon is not set or is empty, the control will not be rendered.");return}super.setup();}async isTorchAvailable(){return f$1(this.frameSource)?this.frameSource.isTorchAvailable():!1}retrieveTorchState(){return f$1(this.frameSource)?this.frameSource.getDesiredTorchState():"off"}},C=class o extends l{constructor(e,r){super(e,r);}static get Camera(){return a$1}static get CameraAccess(){return d}async canShow(){return (await o.CameraAccess.getCameras()).length>1}getImageFromState(){return this.isHover?this.control.pressedImage:this.control.idleImage}async buttonClicked(){if(this.isTransitioning)return;let e=await this.getNextDeviceCamera();e&&await this.switchCameras(e);}setup(){if(this.control.idleImage==null){a.log(a.Level.Warn,"CameraSwitchControl idle icon is not set or is empty, the control will not be rendered.");return}super.setup();}async getNextDeviceCamera(){var u,p;let e=await o.CameraAccess.getCameras(),r=this.frameSource?this.frameSource:null,a=(u=r==null?void 0:r.cameraManager.activeCamera)==null?void 0:u.deviceId,i=e.findIndex(g=>g.deviceId===a);return i>-1?(p=e[i+1])!=null?p:e[0]:e.length>0?e[0]:null}async switchCameras(e){var i;this.isTransitioning=!0;let r=this.frameSource;r!=null&&await r.switchToDesiredState("off");let a=new o.Camera;a.deviceId=e.deviceId,r!=null&&await a.applySettings(new g(r.settings)),await a.switchToDesiredState("on"),await((i=this.context)==null?void 0:i.setFrameSource(a)),this.isTransitioning=!1;}},f=class o extends l{constructor(e,r){super(e,r);}static get Camera(){return a$1}static get CameraAccess(){return d}async install(){let e=await super.install();return e&&await this.setInitialCamera(),e}async canShow(){return !a$2.isIOSDeviceWithExtendedCameraAccess()||!f$1(this.frameSource)?!1:d.isIOSBackDualWideCameraLabel(this.frameSource.label)||d.isIOSBackCameraLabel(this.frameSource.label)||d.isIOSUltraWideBackCameraLabel(this.frameSource.label)}getImageFromState(){return this.isUltraWideBackCamera()?this.isHover?this.control.cameraFOVUltraWidePressedImage:this.control.cameraFOVUltraWideImage:this.isHover?this.control.cameraFOVWidePressedImage:this.control.cameraFOVWideImage}async buttonClicked(){if(this.isTransitioning)return;let e=await this.getAlternativeDeviceCamera();e&&await this.switchCameras(e);}async setInitialCamera(){var e,r;if(!this.isTransitioning&&!d.isIOSBackCameraLabel((r=(e=this.frameSource)==null?void 0:e.label)!=null?r:"")){let i=(await o.CameraAccess.getCameras()).find(u=>d.isIOSBackCameraLabel(u.label));i&&await this.switchCameras(i);}}setup(){if(this.control.cameraFOVUltraWideImage==null||this.control.cameraFOVWideImage==null){a.log(a.Level.Warn,"CameraFOVSwitchControl icon is not set or is empty, the control will not be rendered.");return}super.setup();}isUltraWideBackCamera(){return f$1(this.frameSource)?d.isIOSUltraWideBackCameraLabel(this.frameSource.label):!1}async getAlternativeDeviceCamera(){return (await o.CameraAccess.getCameras()).find(r=>this.isUltraWideBackCamera()?d.isIOSBackCameraLabel(r.label):d.isIOSUltraWideBackCameraLabel(r.label))}async switchCameras(e){var i;this.isTransitioning=!0;let r=this.frameSource;r!=null&&await r.switchToDesiredState("off");let a=new o.Camera;a.deviceId=e.deviceId,r!=null&&await a.applySettings(new g(r.settings)),await a.switchToDesiredState("on"),await((i=this.context)==null?void 0:i.setFrameSource(a)),this.isTransitioning=!1;}};

export { b as a, v as b, C as c, f as d };
